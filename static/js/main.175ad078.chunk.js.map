{"version":3,"sources":["components/Dropdown.js","components/StartPage.js","components/RecordingPage.js","App.js","index.js"],"names":["Dropdown","state","selectedIndex","open","options","componentDidMount","props","select","index","setState","className","onClick","this","icon","faAngleUp","faAngleDown","map","option","key","Component","startRecording","recordingSettings","setRecordingSettings","placeholder","value","width","onChange","e","target","height","frameRate","profile","getRecordingTime","stopRecording","finished","id","autoPlay","muted","RECORDING_CONFIGS","App","recording","startTime","currentTime","chunks","stream","recorder","getCurrentTime","Math","floor","Date","now","getRecordingConfig","config","MediaRecorder","isTypeSupported","c","getValidatedRecordingSetting","isNaN","Number","undefined","a","navigator","mediaDevices","getDisplayMedia","video","audio","console","log","mimeType","start","ondataavailable","push","data","onstop","blob","Blob","loadDurationMetadata","URL","createObjectURL","duration","fixWebmDuration","fixedBlob","createDownloadButton","clearInterval","timer","getTracks","forEach","track","stop","document","getElementById","srcObject","setInterval","url","Promise","resolve","videoElement","src","onloadedmetadata","Infinity","ontimeupdate","createElement","querySelector","appendChild","classList","add","href","download","innerText","max","delta","RecordingPage","StartPage","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.175ad078.chunk.js","sourcesContent":["import React, {Component} from 'react';\r\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\r\nimport {faAngleDown, faAngleUp} from '@fortawesome/free-solid-svg-icons';\r\n\r\nexport default class Dropdown extends Component {\r\n    state = {\r\n        selectedIndex: 0,\r\n        open: false\r\n    }\r\n\r\n    options = [\r\n        ['High Quality (VP9)', 'high'],\r\n        ['Medium Quality (H.264)', 'medium']\r\n    ];\r\n\r\n    componentDidMount = () => this.props.select(this.options[0][1]);\r\n\r\n    select = index => {\r\n        this.setState({selectedIndex: index, open: false});\r\n        this.props.select(this.options[index][1]);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'dropdown'}>\r\n                <div className={'dropdown__selected'} onClick={() => this.setState({open: !this.state.open})}>\r\n                    <div>{this.options[this.state.selectedIndex][0]}</div>\r\n                    <FontAwesomeIcon icon={this.state.open ? faAngleUp : faAngleDown}/>\r\n                </div>\r\n                {this.state.open &&\r\n                <div className={'dropdown__options'}>\r\n                    {this.options.map((option, index) =>\r\n                        <div className={'dropdown__option'} key={index} onClick={() => this.select(index)}>{option[0]}</div>)}\r\n                </div>\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\nimport Dropdown from \"./Dropdown\";\r\n\r\nexport default ({startRecording, recordingSettings, setRecordingSettings}) => (\r\n    <div className={'app'}>\r\n        <div className={'options'}>\r\n            <div className={'options__title'}>Options</div>\r\n\r\n            <div className={'input-field'}>\r\n                <div className={'input-field__name'}>Width</div>\r\n                <div className={'input-field__description'}>Determines the width of the resolution.</div>\r\n                <input className={'input-field__input'} placeholder={'native'} value={recordingSettings.width} onChange={e => setRecordingSettings({width: e.target.value})}/>\r\n            </div>\r\n\r\n            <div className={'input-field'}>\r\n                <div className={'input-field__name'}>Height</div>\r\n                <div className={'input-field__description'}>Determines the height of the resolution.</div>\r\n                <input className={'input-field__input'} placeholder={'native'} value={recordingSettings.height} onChange={e => setRecordingSettings({height: e.target.value})}/>\r\n            </div>\r\n\r\n            <div className={'input-field'}>\r\n                <div className={'input-field__name'}>FPS</div>\r\n                <div className={'input-field__description'}>Determines the FPS.</div>\r\n                <input className={'input-field__input'} placeholder={'native'} value={recordingSettings.frameRate} onChange={e => setRecordingSettings({frameRate: e.target.value})}/>\r\n            </div>\r\n\r\n            <div className={'dropdown-field'}>\r\n                <div className={'input-field__name'}>Video Encoding (Quality)</div>\r\n                <div className={'input-field__description'}>Determines the video encoding (compression) which affects the video quality.</div>\r\n                <Dropdown select={value => setRecordingSettings({profile: value})}/>\r\n            </div>\r\n\r\n            <hr/>\r\n        </div>\r\n\r\n        <div className={'buttons'}>\r\n            <div className={'button'} onClick={() => startRecording()}>Start Recording</div>\r\n        </div>\r\n    </div>\r\n);\r\n","import React from 'react';\r\n\r\nexport default ({getRecordingTime, stopRecording, finished}) => (\r\n    <div className={'app'}>\r\n        <video id={'video'} autoPlay={true} muted={true}/>\r\n        {finished ?\r\n            <div className={'video-caption'}>RECORDING ENDED: Clip duration: {getRecordingTime()}s</div> :\r\n            <div className={'video-caption'}>RECORDING... {getRecordingTime()}s</div>}\r\n\r\n        <div className={'buttons'}>\r\n            {!finished && <div className={'button'} onClick={() => stopRecording()}>Stop Recording</div>}\r\n        </div>\r\n    </div>\r\n);\r\n\r\n","import React, {Component} from 'react';\nimport fixWebmDuration from 'fix-webm-duration';\n\nimport StartPage from './components/StartPage';\nimport RecordingPage from './components/RecordingPage';\n\nconst RECORDING_CONFIGS = {\n    high: 'video/webm; codecs=\"vp9, opus',\n    medium: 'video/webm; codecs=\"h264, opus',\n    fallbacks: [\n        'video/webm; codecs=\"vp8, opus\"',\n        'video/webm',\n    ]\n}\n\nexport default class App extends Component {\n    state = {\n        recording: false,\n        finished: false,\n        startTime: 0,\n        currentTime: 0,\n\n        recordingSettings: {\n            profile: '',\n            width: '',\n            height: '',\n            frameRate: ''\n        }\n    }\n\n    chunks = [];\n    stream = null;\n    recorder = null;\n\n    getCurrentTime = () => Math.floor(Date.now() / 1000);\n\n    getRecordingConfig = () => {\n        let config = '';\n\n        if (this.state.recordingSettings.profile === 'high')\n            config = RECORDING_CONFIGS.high;\n        else if (this.state.recordingSettings.profile === 'medium')\n            config = RECORDING_CONFIGS.medium;\n\n        if (!MediaRecorder.isTypeSupported(config))\n            for (let c of RECORDING_CONFIGS.fallbacks)\n                if (MediaRecorder.isTypeSupported(c)) {\n                    config = c;\n                    break;\n                }\n\n        return config;\n    }\n\n    getValidatedRecordingSetting = value => (value === '' || isNaN(Number(value)) || Number(value) <= 0) ? undefined : Number(value);\n\n    startRecording = async () => {\n        const {width, height, frameRate} = this.state.recordingSettings;\n\n        this.stream = await navigator.mediaDevices.getDisplayMedia({\n            video: {\n                width: this.getValidatedRecordingSetting(width),\n                height: this.getValidatedRecordingSetting(height),\n                frameRate: this.getValidatedRecordingSetting(frameRate)\n            },\n            audio: true\n        });\n\n        console.log({\n            width: this.getValidatedRecordingSetting(width),\n            height: this.getValidatedRecordingSetting(height),\n            frameRate: this.getValidatedRecordingSetting(frameRate)\n        })\n        console.log(this.getRecordingConfig())\n\n        this.recorder = new MediaRecorder(this.stream, {mimeType: this.getRecordingConfig()});\n        this.recorder.start();\n\n        this.recorder.ondataavailable = e => this.chunks.push(e.data);\n\n        this.recorder.onstop = async () => {\n            const blob = new Blob(this.chunks);\n\n            const duration = await this.loadDurationMetadata(URL.createObjectURL(blob)) * 1000;\n\n            fixWebmDuration(blob, duration, fixedBlob =>\n                this.createDownloadButton(URL.createObjectURL(fixedBlob))\n            );\n\n            clearInterval(this.timer);\n\n            if (this.stream !== null) {\n                this.stream.getTracks().forEach(track => track.stop());\n                this.stream = null;\n            }\n\n            this.setState({recording: false, finished: true});\n        }\n\n        this.setState({recording: true, startTime: this.getCurrentTime()});\n\n        document.getElementById('video').srcObject = this.stream;\n\n        this.timer = setInterval(() => this.setState({currentTime: this.getCurrentTime()}), 1000);\n    }\n\n    loadDurationMetadata = async url => new Promise(resolve => {\n        const videoElement = document.getElementById('video');\n        videoElement.srcObject = null;\n        videoElement.src = url;\n\n        videoElement.onloadedmetadata = () => {\n            if (videoElement.duration !== Infinity) return;\n\n            videoElement.currentTime = 1e101;\n            videoElement.ontimeupdate = () => {\n                resolve(videoElement.duration);\n\n                videoElement.currentTime = 0;\n                videoElement.src = null;\n            }\n        }\n    });\n\n    createDownloadButton = url => {\n        const a = document.createElement('a');\n        document.querySelector('.buttons').appendChild(a);\n        a.classList.add('button');\n        a.href = url\n        a.download = 'video.webm';\n        a.innerText = 'Save Recording';\n    }\n\n    stopRecording = async () => this.recorder.stop();\n\n    getRecordingTime = () => Math.max(0, this.state.currentTime - this.state.startTime);\n\n    setRecordingSettings = delta => this.setState({recordingSettings: ({...this.state.recordingSettings, ...delta})});\n\n    render() {\n        return (!this.state.recording && !this.state.finished) ?\n            <StartPage startRecording={() => this.startRecording()} recordingSettings={this.state.recordingSettings} setRecordingSettings={delta => this.setRecordingSettings(delta)}/> :\n            <RecordingPage finished={this.state.finished} getRecordingTime={() => this.getRecordingTime()} stopRecording={() => this.stopRecording()}/>;\n    }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './style/style.css';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App/>\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n"],"sourceRoot":""}