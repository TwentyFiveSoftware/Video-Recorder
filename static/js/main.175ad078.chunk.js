(this["webpackJsonpvideo-recorder"]=this["webpackJsonpvideo-recorder"]||[]).push([[0],{17:function(e,t,n){e.exports=n(29)},28:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),c=n.n(i),o=n(11),s=n(2),d=n.n(s),u=n(3),l=n(16),m=n(4),p=n(5),g=n(7),f=n(6),v=n(14),h=n.n(v),E=n(15),R=n(10),b=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={selectedIndex:0,open:!1},e.options=[["High Quality (VP9)","high"],["Medium Quality (H.264)","medium"]],e.componentDidMount=function(){return e.props.select(e.options[0][1])},e.select=function(t){e.setState({selectedIndex:t,open:!1}),e.props.select(e.options[t][1])},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"dropdown"},r.a.createElement("div",{className:"dropdown__selected",onClick:function(){return e.setState({open:!e.state.open})}},r.a.createElement("div",null,this.options[this.state.selectedIndex][0]),r.a.createElement(E.a,{icon:this.state.open?R.b:R.a})),this.state.open&&r.a.createElement("div",{className:"dropdown__options"},this.options.map((function(t,n){return r.a.createElement("div",{className:"dropdown__option",key:n,onClick:function(){return e.select(n)}},t[0])}))))}}]),n}(a.Component),w=function(e){var t=e.startRecording,n=e.recordingSettings,a=e.setRecordingSettings;return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"options"},r.a.createElement("div",{className:"options__title"},"Options"),r.a.createElement("div",{className:"input-field"},r.a.createElement("div",{className:"input-field__name"},"Width"),r.a.createElement("div",{className:"input-field__description"},"Determines the width of the resolution."),r.a.createElement("input",{className:"input-field__input",placeholder:"native",value:n.width,onChange:function(e){return a({width:e.target.value})}})),r.a.createElement("div",{className:"input-field"},r.a.createElement("div",{className:"input-field__name"},"Height"),r.a.createElement("div",{className:"input-field__description"},"Determines the height of the resolution."),r.a.createElement("input",{className:"input-field__input",placeholder:"native",value:n.height,onChange:function(e){return a({height:e.target.value})}})),r.a.createElement("div",{className:"input-field"},r.a.createElement("div",{className:"input-field__name"},"FPS"),r.a.createElement("div",{className:"input-field__description"},"Determines the FPS."),r.a.createElement("input",{className:"input-field__input",placeholder:"native",value:n.frameRate,onChange:function(e){return a({frameRate:e.target.value})}})),r.a.createElement("div",{className:"dropdown-field"},r.a.createElement("div",{className:"input-field__name"},"Video Encoding (Quality)"),r.a.createElement("div",{className:"input-field__description"},"Determines the video encoding (compression) which affects the video quality."),r.a.createElement(b,{select:function(e){return a({profile:e})}})),r.a.createElement("hr",null)),r.a.createElement("div",{className:"buttons"},r.a.createElement("div",{className:"button",onClick:function(){return t()}},"Start Recording")))},N=function(e){var t=e.getRecordingTime,n=e.stopRecording,a=e.finished;return r.a.createElement("div",{className:"app"},r.a.createElement("video",{id:"video",autoPlay:!0,muted:!0}),a?r.a.createElement("div",{className:"video-caption"},"RECORDING ENDED: Clip duration: ",t(),"s"):r.a.createElement("div",{className:"video-caption"},"RECORDING... ",t(),"s"),r.a.createElement("div",{className:"buttons"},!a&&r.a.createElement("div",{className:"button",onClick:function(){return n()}},"Stop Recording")))},S='video/webm; codecs="vp9, opus',_='video/webm; codecs="h264, opus',y=['video/webm; codecs="vp8, opus"',"video/webm"],O=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={recording:!1,finished:!1,startTime:0,currentTime:0,recordingSettings:{profile:"",width:"",height:"",frameRate:""}},e.chunks=[],e.stream=null,e.recorder=null,e.getCurrentTime=function(){return Math.floor(Date.now()/1e3)},e.getRecordingConfig=function(){var t="";if("high"===e.state.recordingSettings.profile?t=S:"medium"===e.state.recordingSettings.profile&&(t=_),!MediaRecorder.isTypeSupported(t)){var n,a=Object(l.a)(y);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(MediaRecorder.isTypeSupported(r)){t=r;break}}}catch(i){a.e(i)}finally{a.f()}}return t},e.getValidatedRecordingSetting=function(e){return""===e||isNaN(Number(e))||Number(e)<=0?void 0:Number(e)},e.startRecording=Object(u.a)(d.a.mark((function t(){var n,a,r,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.recordingSettings,a=n.width,r=n.height,i=n.frameRate,t.next=3,navigator.mediaDevices.getDisplayMedia({video:{width:e.getValidatedRecordingSetting(a),height:e.getValidatedRecordingSetting(r),frameRate:e.getValidatedRecordingSetting(i)},audio:!0});case 3:e.stream=t.sent,console.log({width:e.getValidatedRecordingSetting(a),height:e.getValidatedRecordingSetting(r),frameRate:e.getValidatedRecordingSetting(i)}),console.log(e.getRecordingConfig()),e.recorder=new MediaRecorder(e.stream,{mimeType:e.getRecordingConfig()}),e.recorder.start(),e.recorder.ondataavailable=function(t){return e.chunks.push(t.data)},e.recorder.onstop=Object(u.a)(d.a.mark((function t(){var n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Blob(e.chunks),t.next=3,e.loadDurationMetadata(URL.createObjectURL(n));case 3:t.t0=t.sent,a=1e3*t.t0,h()(n,a,(function(t){return e.createDownloadButton(URL.createObjectURL(t))})),clearInterval(e.timer),null!==e.stream&&(e.stream.getTracks().forEach((function(e){return e.stop()})),e.stream=null),e.setState({recording:!1,finished:!0});case 9:case"end":return t.stop()}}),t)}))),e.setState({recording:!0,startTime:e.getCurrentTime()}),document.getElementById("video").srcObject=e.stream,e.timer=setInterval((function(){return e.setState({currentTime:e.getCurrentTime()})}),1e3);case 13:case"end":return t.stop()}}),t)}))),e.loadDurationMetadata=function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=document.getElementById("video");n.srcObject=null,n.src=t,n.onloadedmetadata=function(){n.duration===1/0&&(n.currentTime=1e101,n.ontimeupdate=function(){e(n.duration),n.currentTime=0,n.src=null})}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.createDownloadButton=function(e){var t=document.createElement("a");document.querySelector(".buttons").appendChild(t),t.classList.add("button"),t.href=e,t.download="video.webm",t.innerText="Save Recording"},e.stopRecording=Object(u.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.recorder.stop());case 1:case"end":return t.stop()}}),t)}))),e.getRecordingTime=function(){return Math.max(0,e.state.currentTime-e.state.startTime)},e.setRecordingSettings=function(t){return e.setState({recordingSettings:Object(o.a)(Object(o.a)({},e.state.recordingSettings),t)})},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return this.state.recording||this.state.finished?r.a.createElement(N,{finished:this.state.finished,getRecordingTime:function(){return e.getRecordingTime()},stopRecording:function(){return e.stopRecording()}}):r.a.createElement(w,{startRecording:function(){return e.startRecording()},recordingSettings:this.state.recordingSettings,setRecordingSettings:function(t){return e.setRecordingSettings(t)}})}}]),n}(a.Component);n(28);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.175ad078.chunk.js.map